# ==========================================
# OFFICE SCENARIO 2: MarkItDown Only (Fully Offline)
# ==========================================
# Use when: Offline environment, no Azure services, cost optimization
# Requirements: LibreOffice for DOC files
# Limitations: Lower quality extraction, no bounding boxes, no LaTeX
# Best for: Development, air-gapped environments, cost-sensitive deployments
# ==========================================

# ==========================================
# Azure Service Principal Credentials
# NOT REQUIRED for MarkItDown-only mode
# ==========================================
AZURE_TENANT_ID=not-used-markitdown-only
AZURE_CLIENT_ID=not-used-markitdown-only
AZURE_CLIENT_SECRET=not-used-markitdown-only

# ==========================================
# Key Vault Configuration
# NOT USED in MarkItDown-only mode
# ==========================================
# KEY_VAULT_URI=not-used-markitdown-only

# ==========================================
# Document Intelligence
# NOT USED in MarkItDown-only mode
# ==========================================
# AZURE_DOC_INT_ENDPOINT=not-used-markitdown-only
# AZURE_DOC_INT_KEY=not-used-markitdown-only

# ==========================================
# Azure AI Search
# REQUIRED: Even in offline mode for index structure
# ==========================================
AZURE_SEARCH_SERVICE=localhost-or-your-service
AZURE_SEARCH_KEY=your-key-or-mock-for-offline
AZURE_SEARCH_INDEX=offline-index

# ==========================================
# Azure OpenAI
# NOT REQUIRED for MarkItDown-only mode
# ==========================================
# AZURE_OPENAI_ENDPOINT=not-used-markitdown-only
# AZURE_OPENAI_KEY=not-used-markitdown-only

# ==========================================
# Azure Storage Account
# NOT USED in local mode
# ==========================================
# AZURE_STORAGE_ACCOUNT=not-used-local-mode

# ==========================================
# Input Configuration
# ==========================================
AZURE_INPUT_MODE=local
AZURE_LOCAL_GLOB=documents/**/*.{doc,docx,pptx,pdf}
AZURE_ARTIFACTS_DIR=./artifacts

# ==========================================
# Document Action Mode
# ==========================================
AZURE_DOCUMENT_ACTION=add

# ==========================================
# Document Intelligence Extraction
# NOT USED - MarkItDown handles all extraction
# ==========================================
# EXTRACTION_METHOD=not-used-markitdown-only

# ==========================================
# PDF Processing
# ==========================================
SPLIT_PDF_BY_PAGE=false
# pypdf used for PDF extraction (lower quality than Azure DI)

# ==========================================
# Chunking Configuration
# ==========================================
CHUNKER_TARGET_TOKEN_COUNT=8100
CHUNKER_OVERLAP_TOKEN_COUNT=100
CHUNKER_DISABLE_CHAR_LIMIT=true
CHUNKER_CROSS_PAGE_OVERLAP=true

# ==========================================
# Table Processing
# ==========================================
TABLE_RENDER_MODE=markdown
# Only markdown available (no Azure DI for HTML)
TABLE_SUMMARIES=false
# No table summaries (no Azure OpenAI)

# ==========================================
# Figure/Image Processing
# ==========================================
MEDIA_DESCRIBER_MODE=none
# No figure descriptions (no Azure OpenAI)

# ==========================================
# Processing Options
# ==========================================
AZURE_USE_INTEGRATED_VECTORIZATION=false
# No embeddings in offline mode

# ==========================================
# Performance Tuning
# ==========================================
AZURE_MAX_WORKERS=4
AZURE_INNER_ANALYZE_WORKERS=1
AZURE_UPLOAD_DELAY=0
AZURE_EMBED_BATCH_SIZE=0  # No embeddings
AZURE_UPLOAD_BATCH_SIZE=500

# ==========================================
# OFFICE SCENARIO 2: MarkItDown Only (Fully Offline)
# ==========================================
AZURE_OFFICE_EXTRACTOR_MODE=markitdown

# File size limit for Office documents
AZURE_OFFICE_MAX_FILE_SIZE_MB=100

# NO Azure DI equation extraction available
AZURE_OFFICE_EQUATION_EXTRACTION=false

# Verbose logging for debugging
AZURE_OFFICE_VERBOSE=true

# ==========================================
# LIBREOFFICE CONFIGURATION (REQUIRED!)
# ==========================================
# LibreOffice is REQUIRED for DOC/DOCX/PPTX processing in MarkItDown mode
# Install from: https://www.libreoffice.org/download/

# Linux/Mac:
AZURE_OFFICE_LIBREOFFICE_PATH=/usr/bin/soffice

# Windows (uncomment and use this instead):
# AZURE_OFFICE_LIBREOFFICE_PATH=C:\\Program Files\\LibreOffice\\program\\soffice.exe

# To find LibreOffice path:
# Linux: which soffice
# Mac: which soffice (or /Applications/LibreOffice.app/Contents/MacOS/soffice)
# Windows: where soffice (or check C:\Program Files\LibreOffice\program\)

# ==========================================
# FEATURE AVAILABILITY:
# ==========================================
# ‚úÖ DOC Files: Supported via LibreOffice conversion
# ‚úÖ DOCX Processing: Good quality via MarkItDown
# ‚úÖ PPTX Processing: Good quality via MarkItDown
# ‚úÖ PDF Processing: Basic (pypdf fallback)
# ‚úÖ Tables: Markdown format only
# ‚úÖ Offline Operation: Fully offline, no Azure needed
# ‚ùå Bounding Boxes: NOT available
# ‚ùå LaTeX Equations: NOT available
# ‚ùå HTML Tables: NOT available (markdown only)
# ‚ùå Figure Descriptions: NOT available
# ‚ùå Embeddings: NOT available
# üí∞ Cost: FREE (no Azure fees)

# ==========================================
# QUALITY COMPARISON:
# ==========================================
# Text Extraction: Good (70-80% of Azure DI quality)
# Table Structure: Basic markdown only
# Figure Extraction: Images extracted but not described
# Layout Preservation: Basic (no bounding boxes)
# Equation Support: None (plain text only)

# ==========================================
# WHEN TO USE THIS SCENARIO:
# ==========================================
# ‚úÖ Air-gapped/secure environments (no internet)
# ‚úÖ Development without Azure access
# ‚úÖ Cost optimization (no Azure fees)
# ‚úÖ Processing DOC legacy files
# ‚úÖ Offline demos and prototyping
# ‚úÖ Budget constraints
# ‚ùå DON'T use for production requiring high quality
# ‚ùå DON'T use if you need LaTeX equations
# ‚ùå DON'T use if you need bounding boxes

# ==========================================
# INSTALLATION INSTRUCTIONS:
# ==========================================

# Linux (Debian/Ubuntu):
# sudo apt-get update
# sudo apt-get install libreoffice

# Linux (RHEL/CentOS):
# sudo yum install libreoffice

# Mac:
# brew install --cask libreoffice

# Windows:
# Download from: https://www.libreoffice.org/download/
# Install to default location: C:\Program Files\LibreOffice

# Verify installation:
# soffice --version

# ==========================================
# TROUBLESHOOTING:
# ==========================================

# If LibreOffice not found:
# 1. Verify installation: which soffice (Linux/Mac) or where soffice (Windows)
# 2. Update AZURE_OFFICE_LIBREOFFICE_PATH with correct path
# 3. Ensure soffice is executable: chmod +x /usr/bin/soffice (Linux/Mac)

# If conversion fails:
# 1. Check LibreOffice can run: soffice --headless --convert-to pdf test.docx
# 2. Check file permissions
# 3. Enable verbose logging: AZURE_OFFICE_VERBOSE=true

# If tables look wrong:
# 1. MarkItDown outputs markdown tables only
# 2. Complex tables may lose formatting
# 3. Consider using Azure DI for better table quality

# ==========================================
# TO USE THIS FILE:
# ==========================================
# 1. Install LibreOffice (see instructions above)
# 2. Copy: cp envs/env.office-scenario2-markitdown-only.example .env
# 3. Edit AZURE_OFFICE_LIBREOFFICE_PATH with your path
# 4. NO Azure credentials needed!
# 5. Run: prepdocs --glob "documents/**/*.{doc,docx,pptx}"
# ==========================================
