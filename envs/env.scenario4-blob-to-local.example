# ==========================================
# SCENARIO 4: Production Debug
# Blob Input → Local Artifacts
# ==========================================
# Use for: Debugging production files locally
# Read from: Azure Blob Storage INPUT container
# Store to: Local disk (for inspection)
# ==========================================

# ==========================================
# Azure Service Principal Credentials
# ==========================================
AZURE_TENANT_ID=your-tenant-id-here
AZURE_CLIENT_ID=your-client-id-here
AZURE_CLIENT_SECRET=your-client-secret-here

# ==========================================
# Key Vault Configuration (Optional)
# ==========================================
KEY_VAULT_URI=https://your-keyvault.vault.azure.net/

# ==========================================
# Document Intelligence
# ==========================================
AZURE_DOC_INT_ENDPOINT=https://your-di.cognitiveservices.azure.com/
AZURE_DOC_INT_KEY=your-di-key-here
AZURE_DI_MAX_CONCURRENCY=3

# ==========================================
# Azure AI Search
# ==========================================
AZURE_SEARCH_SERVICE=your-search-service
AZURE_SEARCH_KEY=your-search-key-here
AZURE_SEARCH_INDEX=your-debug-index

# ==========================================
# Azure OpenAI
# ==========================================
AZURE_OPENAI_ENDPOINT=https://your-openai.openai.azure.com/
AZURE_OPENAI_KEY=your-openai-key-here
AZURE_OPENAI_API_KEY=your-openai-key-here
AZURE_OPENAI_API_VERSION=2024-12-01-preview
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-ada-002
AZURE_OPENAI_EMBEDDING_MODEL=text-embedding-ada-002
AZURE_OPENAI_EMBEDDING_NAME=text-embedding-ada-002
AZURE_OPENAI_CHAT_DEPLOYMENT=gpt-4o-mini
AZURE_OPENAI_MODEL_NAME=gpt-4o-mini
AZURE_OPENAI_MODEL=gpt-4o-mini

# Concurrency and retries
AZURE_OPENAI_MAX_CONCURRENCY=5
AZURE_OPENAI_MAX_RETRIES=3

# ==========================================
# Azure Storage Account
# ==========================================
AZURE_STORAGE_ACCOUNT=your-storage-account
AZURE_STORAGE_ACCOUNT_KEY=your-storage-key-here
AZURE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=your-storage-account;AccountKey=your-storage-key-here;EndpointSuffix=core.windows.net

# ==========================================
# SCENARIO 4: Blob Input → Local Artifacts
# ==========================================
AZURE_INPUT_MODE=blob

# OPTION 1: Simple configuration using base container name
# Auto-generates: {AZURE_STORAGE_CONTAINER}-input
AZURE_STORAGE_CONTAINER=production-documents

# OPTION 2: Explicit input container name (overrides auto-generation)
# Uncomment if you want explicit control:
# AZURE_BLOB_CONTAINER_IN=production-documents-input

# Optional: Filter to specific subfolder or file
# AZURE_BLOB_PREFIX=documents/problematic/

# Override to store artifacts locally (highest priority!)
AZURE_ARTIFACTS_DIR=./debug_artifacts

# Or use explicit mode:
# AZURE_ARTIFACTS_MODE=local

# IMPORTANT: INPUT container must be pre-created!

# ==========================================
# Document Action Mode
# ==========================================
AZURE_DOCUMENT_ACTION=add
# Options: add, remove, removeall

# ==========================================
# Document Intelligence Extraction
# ==========================================
# Debugging: Use same extraction as production to replicate issues
EXTRACTION_METHOD=layout_then_ocr
# Try different methods if debugging specific extraction issues:
# - layout: Test digital PDF extraction
# - ocr: Test scanned document extraction
# - prebuilt-layout: Test prebuilt model

# DI batch settings (smaller for debugging)
DI_BATCH_SIZE=4
DI_MAX_RETRIES=5

# ==========================================
# PDF Processing
# ==========================================
# Debug: Test page splitting to isolate problematic pages
SPLIT_PDF_BY_PAGE=true
# When debugging, page splitting helps identify which page has issues

# ==========================================
# Chunking Configuration
# ==========================================
# Debug: Use smaller chunks to isolate issues
CHUNKER_TARGET_TOKEN_COUNT=4000
# Smaller chunks help identify problematic content
# Use production settings (8100) to replicate production issues

# Standard overlap
CHUNKER_OVERLAP_TOKEN_COUNT=100

# Token-only chunking
CHUNKER_DISABLE_CHAR_LIMIT=true

# Cross-page overlap
CHUNKER_CROSS_PAGE_OVERLAP=true

# ==========================================
# Table Processing
# ==========================================
# Debug: Test different rendering modes
TABLE_RENDER_MODE=markdown
# Switch to html if markdown tables are problematic

# Table summaries (enable to debug table understanding)
TABLE_SUMMARIES=false
# Set to true to check table summary quality

# ==========================================
# Figure/Image Processing
# ==========================================
# Debug: Use GPT-4o to check figure description quality
MEDIA_DESCRIBER_MODE=gpt4o
# Use gpt4o for detailed descriptions
# Use none if figures aren't the issue

# ==========================================
# Processing Options
# ==========================================
AZURE_USE_INTEGRATED_VECTORIZATION=true

# ==========================================
# Debugging Options
# ==========================================
# Enable verbose logging for all components
LOG_LEVEL=DEBUG

# ==========================================
# Performance Tuning
# ==========================================
AZURE_MAX_WORKERS=2
AZURE_INNER_ANALYZE_WORKERS=1
AZURE_UPLOAD_DELAY=0.5
AZURE_EMBED_BATCH_SIZE=64
AZURE_UPLOAD_BATCH_SIZE=200

# ==========================================
# Office Document Processing
# SCENARIO: Hybrid Mode with Verbose Logging
# ==========================================
AZURE_OFFICE_EXTRACTOR_MODE=hybrid
AZURE_OFFICE_OFFLINE_FALLBACK=true
AZURE_OFFICE_MAX_FILE_SIZE_MB=100
AZURE_OFFICE_EQUATION_EXTRACTION=true
AZURE_OFFICE_VERBOSE=true  # Enable detailed logging for debugging

# Optional: LibreOffice for DOC files
# AZURE_OFFICE_LIBREOFFICE_PATH=/usr/bin/soffice  # Linux/Mac
# AZURE_OFFICE_LIBREOFFICE_PATH=C:\\Program Files\\LibreOffice\\program\\soffice.exe  # Windows

# ==========================================
# TO USE THIS FILE:
# 1. Ensure INPUT container exists in Azure Storage:
#    - Container name: production-documents-input
# 2. Copy this file: cp envs/env.scenario4-blob-to-local.example .env
# 3. Edit .env with your real credentials
# 4. Run with: prepdocs --glob (uses blob prefix)
# 5. Check artifacts in ./debug_artifacts/ for inspection
# ==========================================
