# ==========================================
# SCENARIO 2: Production Deployment
# Blob Input → Blob Artifacts
# ==========================================
# Use for: Production deployment
# Read from: Azure Blob Storage INPUT container
# Store to: Azure Blob Storage OUTPUT containers
# ==========================================

# ==========================================
# Azure Service Principal Credentials
# ==========================================
AZURE_TENANT_ID=your-tenant-id-here
AZURE_CLIENT_ID=your-client-id-here
AZURE_CLIENT_SECRET=your-client-secret-here

# ==========================================
# Key Vault Configuration (Optional)
# ==========================================
KEY_VAULT_URI=https://your-keyvault.vault.azure.net/

# ==========================================
# Document Intelligence
# ==========================================
AZURE_DOC_INT_ENDPOINT=https://your-di.cognitiveservices.azure.com/
AZURE_DOC_INT_KEY=your-di-key-here
AZURE_DI_MAX_CONCURRENCY=5

# ==========================================
# Azure AI Search
# ==========================================
AZURE_SEARCH_SERVICE=your-search-service
AZURE_SEARCH_KEY=your-search-key-here
AZURE_SEARCH_INDEX=your-production-index

# ==========================================
# Azure OpenAI
# ==========================================
AZURE_OPENAI_ENDPOINT=https://your-openai.openai.azure.com/
AZURE_OPENAI_KEY=your-openai-key-here
AZURE_OPENAI_API_KEY=your-openai-key-here
AZURE_OPENAI_API_VERSION=2024-12-01-preview

# Use text-embedding-3-large for production
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-3-large
AZURE_OPENAI_EMBEDDING_MODEL=text-embedding-3-large
AZURE_OPENAI_EMBEDDING_NAME=text-embedding-3-large
AZURE_OPENAI_EMBEDDING_DIMENSIONS=1536

# Use gpt-4o for production figure descriptions
AZURE_OPENAI_CHAT_DEPLOYMENT=gpt-4o
AZURE_OPENAI_MODEL_NAME=gpt-4o
AZURE_OPENAI_MODEL=gpt-4o

# Concurrency and retries
AZURE_OPENAI_MAX_CONCURRENCY=10
AZURE_OPENAI_MAX_RETRIES=5

# ==========================================
# Azure Storage Account
# ==========================================
AZURE_STORAGE_ACCOUNT=your-storage-account
AZURE_STORAGE_ACCOUNT_KEY=your-storage-key-here
AZURE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=your-storage-account;AccountKey=your-storage-key-here;EndpointSuffix=core.windows.net

# ==========================================
# SCENARIO 2: Blob Input → Blob Artifacts
# ==========================================
AZURE_INPUT_MODE=blob

# OPTION 1: Simple configuration using base container name
# Auto-generates: {AZURE_STORAGE_CONTAINER}-input, -pages, -chunks, -images, -citations
AZURE_STORAGE_CONTAINER=production-documents

# OPTION 2: Explicit container names (overrides auto-generation)
# Uncomment these if you want explicit control over container names:
# AZURE_BLOB_CONTAINER_IN=production-documents-input
# AZURE_BLOB_CONTAINER_PREFIX=production-documents
# AZURE_BLOB_CONTAINER_OUT_PAGES=pages
# AZURE_BLOB_CONTAINER_OUT_CHUNKS=chunks
# AZURE_BLOB_CONTAINER_OUT_IMAGES=images
# AZURE_BLOB_CONTAINER_CITATIONS=citations

# Optional: Filter to subfolder within INPUT container
# AZURE_BLOB_PREFIX=documents/2024/

# IMPORTANT: Do NOT set AZURE_ARTIFACTS_DIR here!
# Leave it unset to use blob storage for artifacts

# ==========================================
# Document Action Mode
# ==========================================
AZURE_DOCUMENT_ACTION=add
# Options: add, remove, removeall

# ==========================================
# Document Intelligence Extraction
# ==========================================
# Use highest quality extraction for production
EXTRACTION_METHOD=layout_then_ocr
# Production: layout_then_ocr gives best quality/cost balance
# For scanned documents: use ocr
# For digital PDFs only: use layout

# DI batch settings (higher for production throughput)
DI_BATCH_SIZE=32
DI_MAX_RETRIES=5

# ==========================================
# PDF Processing
# ==========================================
# Enable page splitting for production (enables page-level citations)
SPLIT_PDF_BY_PAGE=true
# Production recommendation: true for better user experience
# Users can cite specific pages in search results

# ==========================================
# Chunking Configuration
# ==========================================
# Production: Balanced chunking for good retrieval
CHUNKER_TARGET_TOKEN_COUNT=8100
# Consider 4000 for high-precision retrieval
# Consider 16000 for more context per chunk

# Standard overlap for production
CHUNKER_OVERLAP_TOKEN_COUNT=100

# Token-only chunking (recommended for production)
CHUNKER_DISABLE_CHAR_LIMIT=true

# Cross-page overlap
CHUNKER_CROSS_PAGE_OVERLAP=true

# ==========================================
# Table Processing
# ==========================================
# Table rendering: markdown is more search-friendly
TABLE_RENDER_MODE=markdown
# Use html if you have complex tables with cell spanning

# Enable table summaries for better search (uses OpenAI)
TABLE_SUMMARIES=false
# Set to true if budget allows - improves table searchability

# ==========================================
# Figure/Image Processing
# ==========================================
# Production: Use GPT-4o for best figure descriptions
MEDIA_DESCRIBER_MODE=gpt4o
# Alternatives:
# - gpt4o-mini: Cheaper, still good quality
# - none: No descriptions (not recommended for production)

# ==========================================
# Processing Options
# ==========================================
AZURE_USE_INTEGRATED_VECTORIZATION=true

# ==========================================
# Performance Tuning (Production Settings)
# ==========================================
AZURE_MAX_WORKERS=8
AZURE_INNER_ANALYZE_WORKERS=2
AZURE_UPLOAD_DELAY=0.1
AZURE_EMBED_BATCH_SIZE=256
AZURE_UPLOAD_BATCH_SIZE=1000

# ==========================================
# Office Document Processing
# SCENARIO: Azure DI Only (Best Quality)
# ==========================================
AZURE_OFFICE_EXTRACTOR_MODE=azure_di
AZURE_OFFICE_MAX_FILE_SIZE_MB=100
AZURE_OFFICE_EQUATION_EXTRACTION=true
AZURE_OFFICE_VERBOSE=false

# Note: DOC files will FAIL in azure_di mode
# For DOC support, use hybrid mode instead

# ==========================================
# TO USE THIS FILE:
# 1. Create INPUT container in Azure Storage:
#    - Container name: production-documents-input
#    - Upload your documents there
# 2. Copy this file: cp envs/env.scenario2-blob-prod.example .env
# 3. Edit .env with your real credentials
# 4. Run: prepdocs --setup-index
# ==========================================
